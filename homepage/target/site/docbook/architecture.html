<!--

    Licensed to the Austrian Association for Software Tool Integration (AASTI)
    under one or more contributor license agreements. See the NOTICE file
    distributed with this work for additional information regarding copyright
    ownership. The AASTI licenses this file to you under the Apache License,
    Version 2.0 (the "License"); you may not use this file except in compliance
    with the License. You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Sep 17, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>
    
    
    
      Chapter 14. Architecture of the OpenEngSB
    </title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");

            
      <!--[if IE]>
      @import url("../css/site-ie-fixes.css");
      <![endif]-->
    </style>

        <!--[if IE]><link rel="stylesheet" href="../css/site-ie-fixes.css" type="text/css" media="all" /><![endif]-->
    <link rel="icon" type="image/x-icon" href="../images/openengsb.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="../images/openengsb.ico" />
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta name="Date-Revision-yyyymmdd" content="20110917" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                                    
<script type="text/javascript">var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-17453231-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type =
          'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
          'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
        })();</script>
                    </head>
  <body class="composite">
<div id="header">
    <div id="banner">
                  <span id="bannerLeft">
                                                <img src="../images/openengsb_small.png" alt="" />
                </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                        <div class="xleft">
        Last Published: 2011-09-17
                  &nbsp;| Version: 2.0.0-SNAPSHOT "Qualified Q"
                      </div>
            <div class="xright">            <a href="http://openengsb.org/" class="externalLink" target="_blank">Final Release</a>
            |
                <a href="http://openengsb.org/milestone" class="externalLink" target="_blank">Milestone Release</a>
            |
                <a href="http://openengsb.org/nightly" class="externalLink" target="_blank">Nightly Release</a>
              
                              </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
</div>   
<div id="body">
	<div id="content">
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                        <div class="menuItem"><h5>OpenEngSB</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../index.html">Welcome</a>
            </li>
                  <li class="none">
                  <a href="../about.html">What is OpenEngSB?</a>
            </li>
                  <li class="none">
                  <a href="../downloads.html">Downloads</a>
            </li>
                  <li class="none">
                  <a href="https://github.com/openengsb/openengsb/raw/master/CHANGELOG.md" class="externalLink" target="_blank">Changelog</a>
            </li>
                  <li class="none">
                  <a href="https://github.com/openengsb/openengsb/blob/master/KNOWN_ISSUES.md" class="externalLink" target="_blank">Known Issues</a>
            </li>
                  <li class="none">
                  <a href="../sponsors.html">Sponsors</a>
            </li>
                  <li class="none">
                  <a href="../subprojects.html">Subprojects</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Quickstart</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../docbook/howto.setup.html">Installation</a>
            </li>
                  <li class="none">
                  <a href="../docbook/howto.logging.html">Connectors and Domains</a>
            </li>
                  <li class="none">
                  <a href="../docbook/howto.contexteditor.html">Events</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Documentation</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../manual/index.html">Manual</a>
            </li>
                  <li class="none">
                  <a href="../reference/faq.html">FAQ</a>
            </li>
                  <li class="none">
                  <a href="../reference/additional.html">Articles</a>
            </li>
                  <li class="none">
                  <a href="http://www.youtube.com/user/cdflexvideo" class="externalLink" target="_blank">Youtube Channel</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Community</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../community/mailinglists.html">Mailing Lists</a>
            </li>
                  <li class="none">
                  <a href="../community/irc.html">IRC Channels</a>
            </li>
                  <li class="none">
                  <a href="http://twitter.com/openEngSB" class="externalLink" target="_blank">Twitter</a>
            </li>
                  <li class="none">
                  <a href="http://www.facebook.com/group.php?gid=208312030232" class="externalLink" target="_blank">Facebook</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Development</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../contribution.html">Contribution</a>
            </li>
                  <li class="none">
                  <a href="../source-repository.html">Source</a>
            </li>
                  <li class="none">
                  <a href="../issue-tracking.html">Issues</a>
            </li>
                  <li class="none">
                  <a href="../integration.html">CI</a>
            </li>
                  <li class="none">
                  <a href="../team-list.html">Team</a>
            </li>
          </ul>
                   
                                    </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
  
  
    
      
      
    
    
      
        
          
            <div class="title"><h2 class="title">
              <a name="architecture" id="architecture"></a>Chapter&#xa0;14.&#xa0;Architecture of
              the OpenEngSB
            <a name="Chapter14.Architecture_of______________the_OpenEngSB"></a></h2>
          
        
      
      <p>
        This chapter tries to give a short summary of the most
        important concepts in the OpenEngSB architecture.
      </p>
      <p>
        The following graphic shows the architecture of the
        OpenEngSB. In the center we use a bus system to integrate
        different modules. In this case we do not use a classical
        Enterprise Service Bus (ESB), but rather the OSGi service
        infrastructure via Spring-DM (<a href="architecture.html#architecture.concept.esb" class="xref" title="14.1. OpenEngSB Enterprise Service Bus (ESB)">Section&#xa0;14.1,
        &#x201c;OpenEngSB Enterprise Service Bus (ESB)&#x201d;</a>). We are using
        <a class="link" href="http://karaf.apache.org" target="_top">Apache Karaf</a> as the OSGi environment.
        Karaf is used in this case, instead of a most basic OSGi
        environment, such as <a class="link" href="http://felix.apache.org" target="_top">Apache
        Felix</a> or <a class="link" href="http://www.eclipse.org" target="_top">Eclipse Equinox</a> , because it supports us
        with additional features as extended console support and
        the feature definitions. This base infrastructure,
        including all modifications required for the OpenEngSB is
        called the <a href="architecture.html#architecture.concept.infrastructure" class="xref" title="14.2. OpenEngSB Infrastructure">Section&#xa0;14.2, &#x201c;
        OpenEngSB Infrastructure&#x201d;</a>. Within the OpenEngSB
        Infrastructure so called <a href="architecture.html#architecture.concept.components" class="xref" title="14.3. OpenEngSB Components">Section&#xa0;14.3, &#x201c;OpenEngSB
        Components&#x201d;</a> and <a href="architecture.html#architecture.concept.tooldomains" class="xref" title="14.4. OpenEngSB Tool Domains">Section&#xa0;14.4, &#x201c;
        OpenEngSB Tool Domains&#x201d;</a> are installed. Both types are
        written in a JVM compatible language, including OSGi
        configuration files to run in the OpenEngSB Infrastructure.
        They are explained later within this chapter. Different
        tools running outside the OpenEngSB Infrastructure are
        called <a href="architecture.html#architecture.concept.clienttools" class="xref" title="14.5. Client Tools (Service Consumer)">Section&#xa0;14.5,
        &#x201c;Client Tools (Service Consumer)&#x201d;</a> or <a href="architecture.html#architecture.concept.domaintools" class="xref" title="14.6. Domain Tools (Service Provider)">Section&#xa0;14.6,
        &#x201c;Domain Tools (Service Provider)&#x201d;</a>, depending on their
        usage scenario. To integrate and use them within the
        OpenEngSB so called <a href="architecture.html#architecture.concept.connectors" class="xref" title="14.7. Domain- and Client Tool Connectors">Section&#xa0;14.7,
        &#x201c;Domain- and Client Tool Connectors&#x201d;</a> are used. All of
        these concepts are explained within the next sections.
      </p>
      
        <img src="graphics/extendedEngSB.png" align="middle" alt="" />
        
          <p>
            Technical view of the OpenEngSB highlighting the most
            important concepts of the integration system
          </p>
        
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.esb" id="architecture.concept.esb"></a>14.1.&#xa0;OpenEngSB
                Enterprise Service Bus (ESB)
              <a name="a14.1.OpenEngSB________________Enterprise_Service_Bus_ESB"></a></h2>
            
          
        
        <p>
          One of the principal concepts for the OpenEngSB
          development is (if possible) to use already existing and
          proven solutions rather than inventing new ones. In this
          manner the OpenEngSB is an extension to the ESB concept.
          Typical ESBs such as <a class="link" href="http://servicemix.apache.org" target="_top">Apache
          Servicemix</a> or other JBI or ESB implementations always
          have the feeling to be huge and bloated. Complex
          integration patterns, messaging, huge configuration files
          and similar concepts/problems lead to this feeling. And
          those feelings are right. They are bloated. The OpenEngsB
          tries a different approach. Using Karaf as its base
          framework the environment is VERY lightweight. Depending
          on your use case you can use different configurations and
          packages out of the box.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.infrastructure" id="architecture.concept.infrastructure"></a>14.2.&#xa0;OpenEngSB
                Infrastructure
              <a name="a14.2.OpenEngSB________________Infrastructure"></a></h2>
            
          
        
        <p>
          While Apache Karaf provides a rich environment and
          functionality we're not done with it. Via the Spring-DM
          extension mechanism, AOP and the OSGi listener model the
          OpenEngSB directly extends the environment to provide own
          commands for the console, fine grained security and a
          full grown workflow model. These extensions are optional
          and not required if you want to use the platform alone.
          Add or remove them as required for your use case.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.components" id="architecture.concept.components"></a>14.3.&#xa0;OpenEngSB
                Components
              <a name="a14.3.OpenEngSB________________Components"></a></h2>
            
          
        
        <p>
          These libraries are the OpenEngSB core. The core is
          responsible to provide the OpenEngSB infrastructure as
          well as general services such as persistence, security
          and workflows. To provide best integration most of these
          components are tied to the OpenEngSB ESB environment.
          Nevertheless, feel free to add or remove them as required
          for your use case.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.tooldomains" id="architecture.concept.tooldomains"></a>14.4.&#xa0;OpenEngSB
                Tool Domains
              <a name="a14.4.OpenEngSB________________Tool_Domains"></a></h2>
            
          
        
        <p>
          Although each tool provider gives a personal touch to its
          product their design is driven by a specific purpose. For
          example, there are many different issue trackers
          available, each having its own advantages and
          disadvantages, but all of them can create issues, assign
          and delete them. Tool Domains are based on this idea and
          distill the common functionality for such a group of
          tools into one Tool Domain interface (and component).
          Tool domains could be compared best to the concept of
          abstract classes in in object orientated programming
          languages. Similar to these, they can contain code,
          workflows, additional logic and data, but they are
          useless without a concrete implementation. Together with
          the ESB, the OpenEngSB infrastructure and the core
          components the tool domains finally result in the
          OpenEngSB.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.clienttools" id="architecture.concept.clienttools"></a>14.5.&#xa0;Client
                Tools (Service Consumer)
              <a name="a14.5.Client________________Tools_Service_Consumer"></a></h2>
            
          
        
        <p>
          Client Tools in the OpenEngSB concept are tools which do
          not provide any services, but consume services provided
          by Tool Domains and Core Components instead. A classical
          example from software engineering for a client tool is
          the Integrated Development Environment (IDE). Developer
          prefer to have the entire development environment,
          reaching from the tickets for a project to its build
          results, at hand. On the other hand they do not need to
          provide any services.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.domaintools" id="architecture.concept.domaintools"></a>14.6.&#xa0;Domain
                Tools (Service Provider)
              <a name="a14.6.Domain________________Tools_Service_Provider"></a></h2>
            
          
        
        <p>
          Domain Tools (Service Provider) Domain Tools, compared to
          Client Tools, denote the other extreme of only providing
          services. Classically, single purpose server tools, like
          issue tracker or chat server, match the category of
          Domain Tools best. Most tools in (software+) engineering
          environments fit of course in both categories, but since
          there are significant technically differences between
          them they are described as two different component types.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.connectors" id="architecture.concept.connectors"></a>14.7.&#xa0;Domain-
                and Client Tool Connectors
              <a name="a14.7.Domain-________________and_Client_Tool_Connectors"></a></h2>
            
          
        
        <p>
          Tool Connectors connect tools to the OpenEngSB
          environment. They implement the respective Tool Domain
          interface. As Client Tool Connectors they provide a
          Client Tool with an access to the OpenEngSB services.
          Again, Domain- and Client Tool Connectors are mostly
          mixed up but separated because of their technical
          differences. Additionally it is worth mentioning that
          tools can be integrated with more than one connector.
          This allows one tool to act in many different domains.
          Apache Maven is an example for such multi-purpose tools,
          relevant for build, as well as test and deploy of Java
          projects.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.edb" id="architecture.concept.edb"></a>14.8.&#xa0;EDB
                (Engineering Data Base)
              <a name="a14.8.EDB________________Engineering_Data_Base"></a></h2>
            
          
        
        <p>
          The EDB is a database with additional versioning feature.
          Its main job is to save and version so called tool data.
          Tool data are information units which are used by tools
          which are connect to the OpenEngSB. The versioning
          feature is necessary because it should be possible to
          restore tool data which has been changed in the meantime.
          Easiest example for this is the handling of signals.
        </p>
        <p>
          Signals are little information units which can for
          example describe a circuit on a board. This circuits are
          once planned and building the base for workers which
          works at another layer (e.g. programmer). If this signals
          are changed and the other layers didn't notice that, the
          final product won't work or even worse. With the EDB it
          is possible to get noticed if a signal has changed and
          you can check what has been changed.
        </p>
        <p>
          The connection between the tools and the EDB is done
          through the EngineeringDatabaseService provided by the
          core/edb bundle. This service gets a datasource
          (database) from the infrastructure/jpa bundle. The
          EngineeringDatabaseService is implemented with JPA, that
          means that every database which support JPA can be used
          as database backend for the EDB. As standard database
          backend was the H2 database chosen.
        </p>
        <p>
          You have also the possibility to replace the database
          backend used for the EDB. A reason for this could be that
          your company wants a more performant database because the
          sets of tooldata are so big that the standard database
          isn't fast enough. For exchanging the database backend
          there are two cases: You want to replace the database
          with another database which is supported by openjpa or
          you take another database which isn't supported by
          openjpa. (List of supported databases can be checked <a class="link" href="http://openjpa.apache.org/builds/1.0.2/apache-openjpa-1.0.2/docs/manual/supported_databases.html" target="_top">here</a>)
        </p>
        <p>
          If you want to replace the standard database with another
          openjpa supported database, the procedure of changing is
          rather simple. You have to change the properties for the
          database connection of the infrastructure/jpa bundle.
          This is done by changing the config file
          &quot;org.openengsb.infrastructure.jpa.cfg&quot;. This file is in
          the &quot;assembly/src/main/filtered-resources/etc&quot; folder.
          This file has following entries:
        </p>
<div class="programlisting"><pre>
    driverClassName=[here shall be the name of your driver class name, 
                     example: org.h2.jdbcx.JdbcDataSource]
    url=[here shall be the url to the used database file, example: jdbc:h2:openengsb]
    username=[here shall be the username for authentication at the database]
    password=[here shall be the password for authentication at the database]
   
</pre></div>
        <p>
          After changing of this file, you have to assure that the
          driver which shall be used by the datasource is loaded at
          runtime. For that you have to load the database driver
          before the connection to the database is established.
          Your database bundle dependency should be added to the
          poms/pom.xml file. A dependency entry for the h2 database
          looks like this (the h2.version is defined as property in
          the same file. Info: had to alter the brackets so that
          they can be shown here. Also there should be a dollar
          sign before the {h2.version} part):
        </p>
<div class="programlisting"><pre>
     [dependency]
       [groupId]com.h2database[/groupId]
       [artifactId]h2[/artifactId]
       [version]{h2.version}[/version]
     [/dependency]
   
</pre></div>
        <p>
          If you made sure the dependency is entered, you have to
          make sure the database is loaded before the database
          connection is established. For that just replace
          following code line in the file
          &quot;assembly/src/main/filtered-resources/features.xml&quot; with
          the new database driver bundle (as you can see you only
          have to copy and paste the values of the dependency):
        </p>
<div class="programlisting"><pre>
     [bundle]mvn:com.h2database/h2/{h2.version}[/bundle]
  
</pre></div>
        <p>
          And thats all you have to do.
        </p>
        <p>
          If you want to replace the standard database with another
          non openjpa supported database you will have to change
          first the datasource like descriped in the last
          paragraph. After that you have to write another bundle
          that provides the EngineeringDatabaseService. In this
          case you also have to reproduce all SQL commands and port
          it for the new database and replace the standard
          EngineeringDatabaseService.
        </p>
        <p>
          Last but not least a few words about the working with the
          EDB. If you have models that shall be versioned by the
          EDB, the easiest way is to build this models as
          interfaces and let them extend the interface
          OpenEngSBModel. Such an interface can only contain getter
          and setter methods, since this interfaces can now be
          proxied through the EngineeringKnowledgeBase (EKB). As
          soon as you have done this, you are able to send such
          models with an event from a connector (Method for that is
          called &quot;sendEDBEvent&quot; and is accessable from every
          connector that AbstractOpenEngSBConnectorService extends,
          which shall be done by all connector implementations.
        </p>
        <p>
          If your domain model requires sub models (like location
          for a contact), you have also to make this sub model an
          interface and let it extend OpenEngSBModel interface. In
          that way, the EDB is able to save all sub models if you
          save the root model. It is even possible to give a model
          a list of submodels, the EDB is able to handle that too
          and you have nothing else to do.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="architecture.concept.ekb" id="architecture.concept.ekb"></a>14.9.&#xa0;EKB
                (Engineering Knowledge Base)
              <a name="a14.9.EKB________________Engineering_Knowledge_Base"></a></h2>
            
          
        
        <p>
          The Engineering Knowledge Base (as it is now) is the
          partner of the EDB. The EKB enables two important
          features:load models from the EDB and generate proxies
          for domain models.
        </p>
        <p>
          The first feature importance is quite clear. The EKB
          enables to load the models which are collected by the
          EDB. It's main work for that feature is to retrieve the
          model in a rare form from the EDB (in a only EDB readable
          format) and convert this rare form to the domain model
          the user requested.
        </p>
        <p>
          The second feature makes it possible to simulate
          implementations of domain models. Like already mentioned
          in the EDB part, every domain model only consists of
          getter and setter pairs and extends the OpenEngSBModel
          interface. If you let the EKB proxy such models, your
          work you have to do to communicate with the EDB and
          versionize models is minimized. Also the EKB proxies does
          the whole converting work from the models to EDB readable
          format for you.
        </p>
      
    
    
      <hr />
      <table border="0" class="bodyTable" width="100%" summary="Navigation footer">
        <tr class="a">
          <td width="40%" align="left">
            <a href="user.quickstart.html">Prev</a>&#xa0;
          </td>
          <td width="20%" align="center">
            <a href="openengsb-manual.html">Home</a>
          </td>
          <td width="40%" align="right">
            &#xa0;<a href="developer.context.html">Next</a>
          </td>
        </tr>
        <tr class="b">
          <td width="40%" align="left" valign="top">
            Chapter&#xa0;13.&#xa0;Quickstart&#xa0;
          </td>
          <td width="20%" align="center">
            <span style="color:white;font-size:85%;"><a class="externalLink" href="http://openengsb.org/" title="OpenEngSB Community">OpenEngSB
            Community</a></span>
          </td>
          <td width="40%" align="right" valign="top">
            &#xa0;Chapter&#xa0;15.&#xa0;Context Management
          </td>
        </tr>
      </table>
    
  </div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    </div>
</div>
    <div id="footer">
      <div class="xright">&#169;            2009-2011
                
                               - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a> <script type="text/javascript" src="http://www.ohloh.net/p/494725/widgets/project_thin_badge.js"></script></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
