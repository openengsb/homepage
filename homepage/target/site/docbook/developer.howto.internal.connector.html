<!--

    Licensed to the Austrian Association for Software Tool Integration (AASTI)
    under one or more contributor license agreements. See the NOTICE file
    distributed with this work for additional information regarding copyright
    ownership. The AASTI licenses this file to you under the Apache License,
    Version 2.0 (the "License"); you may not use this file except in compliance
    with the License. You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Sep 17, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>
    
    
    
      Chapter 40. How To Create an Internal Connector
    </title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");

            
      <!--[if IE]>
      @import url("../css/site-ie-fixes.css");
      <![endif]-->
    </style>

        <!--[if IE]><link rel="stylesheet" href="../css/site-ie-fixes.css" type="text/css" media="all" /><![endif]-->
    <link rel="icon" type="image/x-icon" href="../images/openengsb.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="../images/openengsb.ico" />
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta name="Date-Revision-yyyymmdd" content="20110917" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                                    
<script type="text/javascript">var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-17453231-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type =
          'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
          'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(ga, s);
        })();</script>
                    </head>
  <body class="composite">
<div id="header">
    <div id="banner">
                  <span id="bannerLeft">
                                                <img src="../images/openengsb_small.png" alt="" />
                </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                        <div class="xleft">
        Last Published: 2011-09-17
                  &nbsp;| Version: 2.0.0-SNAPSHOT "Qualified Q"
                      </div>
            <div class="xright">            <a href="http://openengsb.org/" class="externalLink" target="_blank">Final Release</a>
            |
                <a href="http://openengsb.org/milestone" class="externalLink" target="_blank">Milestone Release</a>
            |
                <a href="http://openengsb.org/nightly" class="externalLink" target="_blank">Nightly Release</a>
              
                              </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
</div>   
<div id="body">
	<div id="content">
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                        <div class="menuItem"><h5>OpenEngSB</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../index.html">Welcome</a>
            </li>
                  <li class="none">
                  <a href="../about.html">What is OpenEngSB?</a>
            </li>
                  <li class="none">
                  <a href="../downloads.html">Downloads</a>
            </li>
                  <li class="none">
                  <a href="https://github.com/openengsb/openengsb/raw/master/CHANGELOG.md" class="externalLink" target="_blank">Changelog</a>
            </li>
                  <li class="none">
                  <a href="https://github.com/openengsb/openengsb/blob/master/KNOWN_ISSUES.md" class="externalLink" target="_blank">Known Issues</a>
            </li>
                  <li class="none">
                  <a href="../sponsors.html">Sponsors</a>
            </li>
                  <li class="none">
                  <a href="../subprojects.html">Subprojects</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Quickstart</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../docbook/howto.setup.html">Installation</a>
            </li>
                  <li class="none">
                  <a href="../docbook/howto.logging.html">Connectors and Domains</a>
            </li>
                  <li class="none">
                  <a href="../docbook/howto.contexteditor.html">Events</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Documentation</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../manual/index.html">Manual</a>
            </li>
                  <li class="none">
                  <a href="../reference/faq.html">FAQ</a>
            </li>
                  <li class="none">
                  <a href="../reference/additional.html">Articles</a>
            </li>
                  <li class="none">
                  <a href="http://www.youtube.com/user/cdflexvideo" class="externalLink" target="_blank">Youtube Channel</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Community</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../community/mailinglists.html">Mailing Lists</a>
            </li>
                  <li class="none">
                  <a href="../community/irc.html">IRC Channels</a>
            </li>
                  <li class="none">
                  <a href="http://twitter.com/openEngSB" class="externalLink" target="_blank">Twitter</a>
            </li>
                  <li class="none">
                  <a href="http://www.facebook.com/group.php?gid=208312030232" class="externalLink" target="_blank">Facebook</a>
            </li>
          </ul>
                       <div class="menuItem"><h5>Development</h5></div>
                  <ul>
                  <li class="none">
                  <a href="../contribution.html">Contribution</a>
            </li>
                  <li class="none">
                  <a href="../source-repository.html">Source</a>
            </li>
                  <li class="none">
                  <a href="../issue-tracking.html">Issues</a>
            </li>
                  <li class="none">
                  <a href="../integration.html">CI</a>
            </li>
                  <li class="none">
                  <a href="../team-list.html">Team</a>
            </li>
          </ul>
                   
                                    </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
  
  
    
      
      
    
    
      
        
          
            <div class="title"><h2 class="title">
              <a name="developer.howto.internal.connector" id="developer.howto.internal.connector"></a>Chapter&#xa0;40.&#xa0;How
              To Create an Internal Connector
            <a name="Chapter40.How______________To_Create_an_Internal_Connector"></a></h2>
          
        
      
      <p>
        This chapter describes how to implement a connector for the
        OpenEngSB environment. A connector is an adapter between an
        external tool and the OpenEngSB environment. Every
        connector belongs to a domain which defines the common
        interface of all its connectors. This means that the
        connector is responsible to translate all calls to the
        common interface to the externally provided tool.
      </p>
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="d0e3341" id="d0e3341"></a>40.1.&#xa0;Prerequisites
              <a name="a40.1.Prerequisites"></a></h2>
            
          
        
        <p>
          In case it isn't known what a tool domain is and how it
          defines the interface for the tool connector then <a href="architecture.html#architecture.concept.tooldomains" class="xref" title="14.4. OpenEngSB Tool Domains">Section&#xa0;14.4, &#x201c;
          OpenEngSB Tool Domains&#x201d;</a> is a good starting point. If
          there's already a matching domain for this tool it is
          strongly recommended to use it. If the tool requires a
          new domain to be created relevant information can be
          found in <a href="developer.howto.internal.domain.html" class="xref" title="Chapter 41. How To Create an Internal Domain">Chapter&#xa0;41,
          <i>How To Create an Internal Domain</i></a>.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="d0e3350" id="d0e3350"></a>40.2.&#xa0;Creating a
                new connector project
              <a name="a40.2.Creating_a________________new_connector_project"></a></h2>
            
          
        
        <p>
          To take burden off the developer of creating the initial
          boilerplate code and configuration, a Maven archetype is
          provided for creating the initial project structure.
          Furthermore we provide the <tt>openengsb-maven-plugin</tt> (see <a href="developer.quickstart.html#developer.quickstart.tools.mavenplugin" class="xref" title="39.7.1. openengsb-maven-plugin">Section&#xa0;39.7.1, &#x201c;
          openengsb-maven-plugin&#x201d;</a>) (or the <tt>etc/scripts/gen-connector.sh</tt>
          script, which wraps the invocation of the maven plugin)
          which simplifies the creation of a connector project from
          the archetype. It should be used for assisted creation of
          a new connector project.
        </p>
        
          
            
              
                <div class="title"><h3 class="title">
                  <a name="d0e3363" id="d0e3363"></a>40.2.1.&#xa0;Using
                  the Maven Archetype
                <a name="a40.2.1.Using__________________the_Maven_Archetype"></a></h3>
              
            
          
          <p>
            It is not recommended to use the maven archetype
            directly, because the <tt>genConnector</tt> goal of the
            openengsb-maven-plugin executes additional tasks, I.e.
            renaming of the resulting project. Furthermore, it
            tries to make sure that the new project is consistent
            with the naming conventions of the OpenEngSB project.
          </p>
          <p>
            The following parameters have to be specified to
            execute the correct archetype:
          </p>
          
            <ul class="itemizedlist">
              <li class="listitem">
                archetypeGroupId - the groupId of the OpenEngSB
                connector archetype.
              </li>
              <li class="listitem">
                archetypeArtifactId - the artifactId of the
                OpenEngSB connector archetype.
              </li>
              <li class="listitem">
                archetypeVersion - the current version of the
                OpenEngSB connector archetype.
              </li>
            </ul>
          
          <p>
            The following parameters have to be defined for the
            parent of the new connector. It is not solely parent of
            the connector itself, but parent of the implementation
            of the domain and all other connectors of this domain
            too.
          </p>
          
            <ul class="itemizedlist">
              <li class="listitem">
                parentArtifactId - the artifactId of the project
                parent.
              </li>
            </ul>
          
          <p>
            The following parameters have to be defined for the
            domain of the new connector.
          </p>
          
            <ul class="itemizedlist">
              <li class="listitem">
                groupId - the groupId of the domain.
              </li>
              <li class="listitem">
                domainArtifactId - the artifactId of the domain.
              </li>
            </ul>
          
          <p>
            The following parameters have to be defined for the
            connector.
          </p>
          
            <ul class="itemizedlist">
              <li class="listitem">
                artifactId - the connector artifact id. Has to be
                &quot;openengsb-domains-&lt;yourDomain&gt;-&lt;yourConnector&gt;&quot;.
              </li>
              <li class="listitem">
                version - the package for the source code of the
                domain implementation. Has to be
                &quot;org.openengsb.domains.&lt;yourDomain&gt;&quot;.
              </li>
              <li class="listitem">
                domainInterface - The name of the domain interface.
              </li>
              <li class="listitem">
                parentPackage - The package in which the domain
                interface can be found.
              </li>
              <li class="listitem">
                package - the package for the connector code.
                Usually &lt;parentPackage&gt;.&lt;yourConnector&gt;
                is used.
              </li>
              <li class="listitem">
                name - the name of the implementation module. Has
                to be &quot;OpenEngSB :: Domains :: &lt;yourDomain&gt;
                :: &lt;yourConnector&gt;&quot;
              </li>
            </ul>
          
          <p>
            Where &lt;yourDomain&gt; has to be replaced by your
            domain name and &lt;yourConnector&gt; has to be
            replaced by the respective connector name.
          </p>
          <p>
            Note that the archetype will use the artifactId to name
            the project, but the OpenEngSB convention is to use the
            connector name. Therefore you will have to rename the
            resulting project (however if you use the <tt>genConnector</tt> mojo, this renaming
            will be performed automatically). Do not forget to
            check that the new connector is included in the modules
            section of the domain parent pom.
          </p>
        
        
          
            
              
                </div><div class="title"><h3 class="title">
                  <a name="d0e3416" id="d0e3416"></a>40.2.2.&#xa0;Using
                  <tt>mvn
                  openengsb:genConnector</tt>
                <a name="a40.2.2.Using__________________mvn__________________openengsb:genConnector"></a></h3>
              
            
          
          <p>
            Simply invoke <tt>mvn
            openengsb:genConnector</tt> from the connector
            directory (<tt>connector/</tt>)
            (alternatively the <tt>etc/scripts/gen-connector.sh</tt>
            script can be used which invokes the
            openengsb-maven-plugin for you).
          </p>
          
            <p>
              <br />
              &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;<span class="command"><b>connector&#xa0;$</b></span>&#xa0;mvn&#xa0;openengsb:genConnector<br />
              &#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;
            </p>
          
          <p>
            The mojo tries to guess as much as possible from your
            previous input. Guessed values are displayed in
            brackets. If the guess is what you want, simply
            acknowledge with <tt>Return</tt>.
            The following output has been recorded by executing the
            script in the <tt>connector/</tt>
            directory:
          </p>
          
            <p>
              <span class="command"><b>Domain&#xa0;Name&#xa0;[domain]:&#xa0;</b></span>notification&#xa0;&lt;Enter&gt;<br />
              <span class="command"><b>Domain&#xa0;Interface&#xa0;[NotificationDomain]:&#xa0;</b></span>&lt;Enter&gt;<br />
              <span class="command"><b>Connector&#xa0;Name&#xa0;[myconnector]:&#xa0;</b></span>twitter&#xa0;&lt;Enter&gt;<br />
              <span class="command"><b>Version&#xa0;[1.0.0-SNAPSHOT]:&#xa0;</b></span>&lt;Enter&gt;<br />
              <span class="command"><b>Project&#xa0;Name&#xa0;[OpenEngSB&#xa0;::&#xa0;Domains&#xa0;::&#xa0;Notification&#xa0;::&#xa0;Twitter]:&#xa0;</b></span>&lt;Enter&gt;
            </p>
          
          <p>
            Only the domain and connector name was set, everything
            else has been guessed correctly. After these inputs are
            provided the Maven Archetype gets called and may ask
            you for further inputs. You can simply hit <tt>Return</tt> each time to acknowledge
            standard values. If it finishes successfully the new
            connector project is created and you may start
            implementing.
          </p>
        
      
      
        
          
            
              </div></div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="d0e3466" id="d0e3466"></a>40.3.&#xa0;Project
                Structure
              <a name="a40.3.Project________________Structure"></a></h2>
            
          
        
        <p>
          The newly created connector project should have the exact
          same structure as the following listing:
        </p>
<div class="programlisting"><pre>
-- pom.xml
-- src
   -- main
      -- java
      |  -- org
      |     -- openengsb
      |        -- domains
      |           -- notification
      |              -- twitter
      |                 -- internal
      |                 |  -- MyServiceImpl.java
      |                 |  -- MyServiceInstanceFactory.java
      |                 -- MyServiceManager.java
      -- resources
         -- META-INF
         |  -- spring
         |     -- connector-context.xml
         -- OSGI-INF
            -- l10n
               -- bundle_de.properties
               -- bundle.properties
</pre></div>
        <p>
          The <tt>MyServiceImpl</tt> class
          implements the interface of the domain and thus is the
          communication link between the OpenEngSB and the
          connected tool. To give the OpenEngSB (and in the long
          run the end user) enough information on how to configure
          a connector, the <tt>MyServiceInstanceFactory</tt> class
          provides the OpenEngSB with meta information for
          configuring and functionality for creating and updating a
          connector instances. The <tt>MyServiceManager</tt> class connects
          connector instances with the underlying OSGi engine and
          OpenEngSB infrastructure. It exports instances as OSGi
          services and adds necessary meta information to each
          instance. Since the basic functionality is mostly similar
          for all service managers, the <tt>MyServiceManager</tt> class extends a
          common base class <tt>AbstractServiceManager</tt>. In
          addition the <tt>AbstractServiceManager</tt> also
          persists the configuration of each connector, so that the
          connector instances can be restored after a system
          restart.
        </p>
        <p>
          The spring setup in the resources folder contains the
          setup of the service manager. Additional bean setup and
          dependency injection can be configured there.
        </p>
        <p>
          The OpenEngSB has been designed with localization in
          mind. The Maven Archetype already generates two <tt>bundle*.properties</tt> files, one for
          English (bundle.properties) and one for the German
          (bundle_de.properties) language. Each connector has to
          provide localization through the properties files for
          service and attributes text values. This includes
          localization for names, descriptions, attribute
          validation, option values and more. For convenience the
          <tt>BundleStrings</tt> class is
          provided on all method calls where text is needed for
          user representation for a specific locale.
        </p>
      
      
        
          
            
              </div><div class="title" style="clear: both"><h2 class="title" style="clear: both">
                <a name="d0e3503" id="d0e3503"></a>40.4.&#xa0;Integrating the Connector
                into the OpenEngSB environment
              <a name="a40.4.Integrating_the_Connector________________into_the_OpenEngSB_environment"></a></h2>
            
          
        
        <p>
          The service manager is responsible for the integration of
          the connector into the OpenEngSB infrastructure. The
          correct definition of this service is critical.
        </p>
      
    
    
      <hr />
      <table border="0" class="bodyTable" width="100%" summary="Navigation footer">
        <tr class="a">
          <td width="40%" align="left">
            <a href="developer.quickstart.html">Prev</a>&#xa0;
          </td>
          <td width="20%" align="center">
            <a href="openengsb-manual.html">Home</a>
          </td>
          <td width="40%" align="right">
            &#xa0;<a href="developer.howto.internal.domain.html">Next</a>
          </td>
        </tr>
        <tr class="b">
          <td width="40%" align="left" valign="top">
            Chapter&#xa0;39.&#xa0;Getting Started as a Developer&#xa0;
          </td>
          <td width="20%" align="center">
            <span style="color:white;font-size:85%;"><a class="externalLink" href="http://openengsb.org/" title="OpenEngSB Community">OpenEngSB
            Community</a></span>
          </td>
          <td width="40%" align="right" valign="top">
            &#xa0;Chapter&#xa0;41.&#xa0;How To Create an Internal Domain
          </td>
        </tr>
      </table>
    
  </div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    </div>
</div>
    <div id="footer">
      <div class="xright">&#169;            2009-2011
                
                               - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a> <script type="text/javascript" src="http://www.ohloh.net/p/494725/widgets/project_thin_badge.js"></script></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
